<div class="rule-details-expanded">
    <div class="detail-header">
        <h2>{{ rule.name }}</h2>
        <p>{{ rule.description }}</p>
        <button 
            class="btn btn-small btn-primary"
            hx-get="/rule/conditions/new"
            hx-target="#condition-form-{{ rule_id }}"
            hx-swap="innerHTML">
            + Add Condition
        </button>
    </div>

    <div id="condition-form-{{ rule_id }}" class="condition-form-container"></div>

    <div class="conditions-section">
        <h5>Conditions ({{ rule.logical_operator }})</h5>
        <div id="conditions-list-{{ rule_id }}" class="conditions-list">
            {% if rule.conditions.is_empty() %}
            <p class="text-muted">No conditions yet. Add at least one condition to make this rule active.</p>
            {% else %}
            {% for condition in rule.conditions %}
            {% include "condition_row.html" %}
            {% endfor %}
            {% endif %}
        </div>
    </div>

    <div class="validation-section">
        <button 
            class="btn btn-secondary"
            hx-post="/rule/validate"
            hx-target="#validation-result-{{ rule_id }}"
            hx-swap="innerHTML">
            Validate Rule
        </button>
        <div id="validation-result-{{ rule_id }}"></div>
    </div>

    <div class="ast-preview">
        <h5>AST Preview (JSON)</h5>
        <div 
            id="ast-preview-{{ rule_id }}"
            hx-get="/rule/ast"
            hx-trigger="conditionChanged from:body"
            hx-swap="innerHTML">
            <pre><code>{{ rule_json }}</code></pre>
        </div>
    </div>
</div>

